# Lab 1

## Lab 01-01

## 1. Upload the files to http://www.VirusTotal.com/ and view the reports. Does either file match any existing antivirus signatures?

**lab01-01.dll**

![result when submitting the dll to Virustotal](virusTotalDLL.png)

**lab01-01.exe**

![result when submitting the exe to Virustotal](virusTotalEXE.png)


## 2. When were these files compiled?

Well using PE-bear, I was able to get the time the file is compiled.

**lab01-01.dll**

![When is the DLL compiled](compiledTime_dll.png)

**lab01-01.exe**

![When is the EXE compiled](compiledTime_exe.png)

## 3. Are there any indications that either of these files is packed or obfuscated? If so, what are these indicators?

Using PEiD the files doesn't seems to be packed

**lab01-01.dll**

![Using PEiD to show dll not packed](PEiD_dll.png)

**lab01-01.exe**

![Using PEiD to show exe not packed](PEiD_exe.png)

## 4. Do any imports hint at what this malware does? If so, which imports are they?

 - lab01-01.exe
	 - KERNEL32.dll
		 - ![Imported functions from KERNEL32.dll in exe file](exe_kernel32_import.png)
		 - This DLL file is quite common in most binary file. In this case, it mostly importing functions to create new files as well as finding certain files in the system.
	 - MSVCRT.dll
		 - ![Imported functions from MSVCRT.dll in exe file](exe_msvcrt_import.png)
		 - MSVCRT.dll is a standard library for Visual C++ which provides programs with most of the standard C library functions.
- lab01-01.dll
	- KERNEL32.dll
		- ![Imported functions from KERNEL32.dll in dll file](dll_kernel32_import.png)
		- Quite similar to the exe file imports, but this time, mutex is involved in the imports.
		- A mutex object protects a shared resource from multiple access by threads and processes. Malware author uses this to make sure they do not reinfect an already infected system. 
	- WS2_32.dll
		- ![Providing networking functionality to binary with WS2_32.dll](dll_WS2_32_usage.png)
		- This linked library is used to handle network connections


## 5. Are there any other files or host-based indicators that you could look for on infected systems?  

A file is found when running **strings** with the DLL file named  Kernel132.dll. This "Kernel132.dll" file might be the file that will override the real KERNEL32 by disguising it. Besides that, the lab01-01.dll DLL file is also not a common system DLL file. We could use these files as an IOC to identify infected systems.

![file IOC](file_IOC.png)

## 6. What network-based indicators could be used to find this malware on infected machines?

When using the **strings** command to get the strings in the lab01-01.dll file, it's found that the file will be communicating with a server host at ```127.26.152.13```. This could be our IOC in detecting the infection through network traffic sniffing and monitoring.

![Network IOC](network_IOC.png)

## 7. What would you guess is the purpose of these files?

These files most probably will create a backdoor in the victim's machine. Then, once the malware is executed, the malware will connect to a C2 server where further instruction is processed to the malware installed. For the malware to successfully exploit the system, it needs to replace the KERNEL32.dll with another malicious file. The WS2_32 library makes the network connections. The DLL file also utilized the sleep function, which stopped the execution of the malware. They will continue executing other commands after receiving the correct command from the C2 server.

## Lab 01-02

## 1. Upload the Lab01-02.exe file to http://www.VirusTotal.com/. Does it match any existing antivirus definitions?

![virustotal scan for lab01-02](lab01_02.png)

## 2. Are there any indications that this file is packed or obfuscated? If so, what are these indicators? If the file is packed, unpack it if possible.

Using PeiD, We can see that the executable is being packed by upx

![Executable is packed by upx](lab01_02_packed.png)

We can use back UPX to unpack the file

![Unpacking the file using upx](lab01_02_unpack.png)

![unpacked file](lab01_02_unpacked.png)

## 3. Do any imports hint at this programâ€™s functionality? If so, which imports are they and what do they tell you?

The program seems to be importing functions from Kernel32.dll to create a mutex for the program, which are normally used by alot of malware. The program also seems to be using threading in the program. 

![Kernel32.dll functions import](lab01_02_imports_kernel32.png)

Next, the program also import functions from ADVAPI32.dll. This library contains library that supports security and registry calls. The functions that are imported seems to be creating service(s) for the program. 

![ADVAPI.dll functions import](lab01_02_imports_advapi32.png)

Then, the program also imports function from WININET.dll to use HTTP protocol to access the internet resources.

![WININET.dll functions import](lab01_02_imports_wininet.png)


## 4.  What host- or network-based indicators could be used to identify this malware on infected machines?

Using the strings utilities, some rather interesting string is found.

![lab01-02 IOC](lab01_02_ioc.png)

We can see that there are some names that the program uses. "MalService", "malservice", "HGL34", might be the name uses in Mutex or service of the malware. There's also a url that we could use as an network IOC in detecting the malicious program activity in our network.

## Reverse engineering lab01-02 
Using Ghidra, I performed a simple analysis on the program. I found  that "Malservice" is used as the service name of the program when executed.

![lab01-02 service name used](lab01_02_serviceName.png)

While, a bit above the code, we can see that "HGL345" is used as the Mutex name for the program.

![lab01-02 mutex name used](lab01_02_mutexName.png)

## Lab 01-03

## 1. Upload the Lab01-03.exe file to http://www.VirusTotal.com/. Does it match any existing antivirus definitions?

Yup, matched.

![lab01-03 virustotal scan](lab01_03.png)

## 2. Are there any indications that this file is packed or obfuscated? If so, what are these indicators? If the file is packed, unpack it if possible.

using PEiD again, it's rather obvious that the file is packed. The entrypoint and the file offset is different, and the compiler shown for the file is "FSG 1.0 -> dulek/xt". Not to mention, the program only import two functions.

![lab01-03 is packed](lab01_03_packed.png)

![lab01-03 function import when packed](lab01_03_packed_imports.png)

Not sure what that is but after some research,





