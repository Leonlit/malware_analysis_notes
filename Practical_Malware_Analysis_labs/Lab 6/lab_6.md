# Lab 6

## Lab 06-01

### 1. What is the major code construct found in the only subroutine called by main?

The only subroutine that would be called by main is located at 0x401000. Going into the 

### 2. What is the subroutine located at 0x40105F?

Looking into the code at sub_40105F, we will quickly find ourselve in a rabbit hole where the proceding code found is unending. This unending rabbit-hole normally implies that the subroutine is a function from the standard library. One hint that stands out is that the subroutine was called right after a String is pushed onto the stack. Normally the reason for the program to use a string is to print out a text to the stdout. Also, the String also contains message that are meant to be shown to a user. This shows that the subroutine is probably the printf function from the stdio library. 

### 3. What is the purpose of this program?

The program imports InternetGetConnectedState function from WININET.dll and check if there's internet connection on the machine. According to its documentation on Windows page [^1], we can see that the function will return True if therer is an active LAN/modem internet connection and False otherwise. In assembly False would be 0 while, True would be 1. In the code at sub_40105F, we can see that after InternetGetConnectedState function call, the program would compare the EAX value with 0. Next, the JZ (jump zero) instruction would redirect the program to sub_40102B if InternetGetConnectedState returns False(0). Since 0 cmp 0 would not set the Zero flag. Then, continue at 0x401017 if that is not the case. Both route would print out the status of the internet connection respectively.  



[^1]: https://learn.microsoft.com/en-us/windows/win32/api/wininet/nf-wininet-internetgetconnectedstate